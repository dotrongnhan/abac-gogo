# Run all tests
go test ./...
# Run specific package tests
go test ./evaluator -v
go test ./storage -v
# Run benchmarks
go test -bench=. -benchmem
/dev/fd/14:type:332: bad option: -t
➜  ABAC-gogo-example # Run all tests
➜  ABAC-gogo-example go test ./...
ok      abac_go_example 0.014s [no tests to run]
ok      abac_go_example/attributes      0.017s
ok      abac_go_example/audit   0.010s
?       abac_go_example/cmd/migrate     [no test files]
2025/10/24 22:37:27 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[IPInRange:map[environment.client_ip:[192.168.1.0/24 10.0.0.0/8]] IsBusinessHours:map[environment.is_business_hours:true] StringContains:map[user.department:Engineering] StringEquals:map[user.subject_type:employee]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[IPInRange:map[environment.client_ip:[192.168.1.0/24 10.0.0.0/8]] IsBusinessHours:map[environment.is_business_hours:true] StringContains:map[user.department:Engineering] StringEquals:map[user.subject_type:employee]]
--- FAIL: TestImprovedPDP_RealWorldScenarios (0.00s)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Business_hours_document_access_-_should_allow (0.00s)
        integration_test.go:423: Expected result permit, got deny. Reason: No matching policies found (implicit deny)
        integration_test.go:429: Evaluation time should be positive
        integration_test.go:433: Scenario: Employee accessing documents during business hours from office IP
        integration_test.go:434: Result: deny (in 0ms)
        integration_test.go:435: Reason: No matching policies found (implicit deny)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Confidential_document_access_-_should_allow_for_senior_staff (0.00s)
        integration_test.go:423: Expected result permit, got deny. Reason: No matching policies found (implicit deny)
        integration_test.go:429: Evaluation time should be positive
        integration_test.go:433: Scenario: Senior staff with confidential clearance accessing confidential documents
        integration_test.go:434: Result: deny (in 0ms)
        integration_test.go:435: Reason: No matching policies found (implicit deny)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Weekend_restriction_-_should_deny_sensitive_operations (0.00s)
        integration_test.go:419: Evaluation failed: failed to enrich context: failed to get action: action not found: document:delete
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Mobile_device_restriction_-_should_deny_admin_actions (0.00s)
        integration_test.go:429: Evaluation time should be positive
        integration_test.go:433: Scenario: Admin action blocked from mobile device
        integration_test.go:434: Result: deny (in 0ms)
        integration_test.go:435: Reason: No matching policies found (implicit deny)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/After_hours_access_-_should_deny (0.00s)
        integration_test.go:429: Evaluation time should be positive
        integration_test.go:433: Scenario: Document access blocked after business hours
        integration_test.go:434: Result: deny (in 0ms)
        integration_test.go:435: Reason: No matching policies found (implicit deny)
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-0]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-2]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-0]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-2]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-0]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-2]]
2025/10/24 22:37:27 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThanEquals:map[user.level:5] StringEquals:map[user.department:Engineering]]
2025/10/24 22:37:27 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:27 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:27 Debug: Legacy condition evaluation failed for conditions: map[StringEquals:map[resource.sensitivity:confidential]]
2025/10/24 22:37:27 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:27 Info: UserId not provided in context - some policies may not evaluate correctly
FAIL
FAIL    abac_go_example/evaluator       0.016s
?       abac_go_example/examples        [no test files]
?       abac_go_example/examples/improved_pdp   [no test files]
ok      abac_go_example/models  0.012s
ok      abac_go_example/operators       0.009s

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[15.961ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.228ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[13.388ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.341ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.265ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.178ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.964ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.171ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.093ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.543ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.066ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.940ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.011ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.722ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.060ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.579ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.999ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.522ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.090ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.087ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.894ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.912ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.755ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.937ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.939ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.846ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.878ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.937ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.719ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.668ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.645ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.438ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.121ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.431ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.348ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.449ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.879ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.218ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.582ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.542ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.923ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.980ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 
[0.509ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 
[6.264ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:27 
[0.603ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:27 
[8.634ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 
[10.115ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:27 
[0.820ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.706ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:27 
[1.279ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.977ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.970ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.945ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.850ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.756ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.681ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.443ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.889ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.323ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.037ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.152ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.588ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.320ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.920ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.913ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 
[0.657ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 
[5.512ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:27 
[0.653ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:27 
[7.285ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 
[8.827ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:27 
[0.982ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.889ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:27 
[0.639ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.083ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.814ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 
[0.475ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 
[1.874ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:27 
[0.621ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:27 
[1.167ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 
[1.127ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:27 
[0.568ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.509ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.742ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.680ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.544ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.528ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.558ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.442ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.412ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.819ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.322ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.624ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.028ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.279ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.464ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.511ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.739ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.844ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.775ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.972ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.716ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.836ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.642ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.691ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.727ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.598ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.671ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.572ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.693ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.724ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.615ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.655ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.499ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.612ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.490ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.513ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[3.056ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:27.797','2025-10-24 15:37:27.797')

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.495ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:27.8','2025-10-24 15:37:27.8')

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.200ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:27.801','2025-10-24 15:37:27.801')

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.682ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:27.802')

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.208ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:27.804')

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.911ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.345ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.299ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.954ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:27.81','2025-10-24 15:37:27.81')

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.338ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.328ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.524ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.465ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.482ms] [rows:3] DELETE FROM subjects
--- FAIL: TestHTTPMiddleware_Handler (0.31s)
    test_helper.go:252: Failed to create test policy: failed to create policy: ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.661ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.074ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[12.455ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.093ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.380ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.222ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.699ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.621ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.332ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.526ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.259ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.483ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.772ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.044ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.087ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.252ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.929ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.493ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.048ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.884ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.489ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.225ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.710ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.963ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.820ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.739ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.755ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.727ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.988ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.849ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.878ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.098ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.929ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.941ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.897ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.427ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.838ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.806ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.414ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.734ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.191ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.971ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 
[0.479ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 
[7.019ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:27 
[0.632ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:27 
[7.566ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:27 
[8.279ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:27 
[0.986ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.155ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:27 
[1.407ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.776ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.655ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.656ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.609ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.655ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.595ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.554ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.908ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.479ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.277ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:27 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.607ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.784ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.457ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.297ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.867ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.457ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[4.693ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.767ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[6.108ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[5.986ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.839ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.524ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:28 
[0.617ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.685ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.812ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.404ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[1.554ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.562ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[1.121ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[1.085ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.510ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.154ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.935ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.781ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.686ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.771ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.628ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.590ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.518ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.899ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.546ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.502ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.959ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.046ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.086ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.543ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.711ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.702ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.875ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.896ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.830ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.696ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.735ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.755ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.752ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.631ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.553ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.587ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.669ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.646ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.666ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.736ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.707ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.704ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.557ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.583ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.508ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:28.075','2025-10-24 15:37:28.075')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.409ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:28.078','2025-10-24 15:37:28.078')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.240ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:28.079','2025-10-24 15:37:28.079')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.620ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:28.08')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.212ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:28.082')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.532ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.139ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.188ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.770ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:28.088','2025-10-24 15:37:28.088')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.409ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.373ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.513ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.552ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.719ms] [rows:3] DELETE FROM subjects
--- FAIL: TestRESTfulMiddleware (0.28s)
    test_helper.go:252: Failed to create test policy: failed to create policy: ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.783ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.104ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[12.380ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.601ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.336ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.626ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.631ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.607ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.217ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.172ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.811ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.457ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.547ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.728ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.737ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.220ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.032ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.471ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.794ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.889ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.180ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.069ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.932ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.972ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.925ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.819ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.826ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.746ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.754ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.942ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.859ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.406ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.034ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.510ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.903ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.423ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.586ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.856ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.779ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.744ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.907ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.996ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.643ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[5.010ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:28 
[0.561ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:28 
[6.508ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[6.481ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:28 
[0.936ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.755ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:28 
[1.699ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.873ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.802ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.969ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.827ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.751ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.656ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.622ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.121ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.642ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.144ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.137ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.129ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.316ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.806ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.794ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.581ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[4.608ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.574ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[6.443ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[10.189ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.857ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.876ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:28 
[0.796ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.825ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.926ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.543ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[1.768ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.655ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[1.173ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[1.191ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.576ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.101ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.747ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.648ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.686ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.606ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.593ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.496ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.517ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.952ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.403ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.415ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.959ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.093ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.579ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.614ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.769ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.983ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.713ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.709ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.773ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.756ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.706ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.673ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.753ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.648ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.602ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.638ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.579ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.576ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.617ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.748ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.630ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.617ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.488ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.498ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.476ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:28.364','2025-10-24 15:37:28.364')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.661ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:28.367','2025-10-24 15:37:28.367')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.436ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:28.368','2025-10-24 15:37:28.368')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.875ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:28.37')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.431ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:28.372')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.750ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.611ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.406ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.886ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:28.378','2025-10-24 15:37:28.378')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.359ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.407ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.508ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.593ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.460ms] [rows:3] DELETE FROM subjects
--- FAIL: TestSimplePolicyEnforcementPoint_EnforceRequest (0.29s)
    test_helper.go:252: Failed to create test policy: failed to create policy: ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.302ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.133ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[11.887ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.151ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.831ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.514ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.936ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.942ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.701ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.253ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.767ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.191ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.507ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.838ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.967ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.612ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.006ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.487ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.760ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.913ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.695ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.419ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.948ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.979ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.968ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.018ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.750ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.734ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.756ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.048ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.759ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.160ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.243ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.126ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.991ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.534ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.141ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.375ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.244ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.584ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.805ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.810ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.521ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[4.160ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:28 
[0.568ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:28 
[6.457ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[6.380ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:28 
[0.824ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.657ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:28 
[1.379ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.057ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.962ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.987ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.784ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.655ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.682ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.645ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.001ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.522ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.801ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.131ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.574ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.049ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.962ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.847ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.562ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[4.846ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.714ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[8.371ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[6.226ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.835ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.402ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:28 
[0.663ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.948ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.944ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.494ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[1.523ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.584ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[1.060ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[1.087ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.563ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.092ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.937ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.776ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.890ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.611ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.607ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.449ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.434ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.818ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.375ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.483ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.937ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.981ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.140ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.585ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.751ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.712ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.713ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.857ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.675ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.719ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.677ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.720ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.698ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.590ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.574ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.608ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.639ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.627ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.608ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.586ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.615ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.632ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.574ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.549ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.539ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:28.642','2025-10-24 15:37:28.642')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.050ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:28.645','2025-10-24 15:37:28.645')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.752ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:28.647','2025-10-24 15:37:28.647')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.886ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:28.649')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.380ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:28.651')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[2.329ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[2.030ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.354ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.680ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:28.658','2025-10-24 15:37:28.658')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.385ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.353ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.487ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.496ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.601ms] [rows:3] DELETE FROM subjects
--- FAIL: TestSimplePolicyEnforcementPoint_Metrics (0.28s)
    test_helper.go:252: Failed to create test policy: failed to create policy: ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.788ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.204ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[11.847ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.972ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.773ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.981ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.670ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.111ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.735ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.198ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.453ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.879ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.328ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.850ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.998ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.116ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.458ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.572ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.179ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.018ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.655ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.167ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.013ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.761ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.703ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.676ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.639ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.805ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.735ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.699ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.790ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.109ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.070ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.989ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.329ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.433ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.600ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.930ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[7.946ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.574ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.814ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.763ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.579ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[4.581ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:28 
[0.614ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:28 
[6.377ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[6.008ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:28 
[0.956ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.250ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:28 
[1.150ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.974ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.681ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.681ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.158ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.558ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.499ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.652ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.969ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.420ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.175ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.988ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.629ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.124ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.837ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.742ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.567ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[4.778ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.557ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[6.398ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[6.105ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.661ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.954ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:28 
[0.674ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.044ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.694ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 
[0.496ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 
[1.898ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:28 
[0.737ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:28 
[1.344ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 
[1.208ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:28 
[0.597ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.199ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.935ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.697ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.719ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.617ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.625ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.494ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.487ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.941ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.400ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.618ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.020ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.095ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.024ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.559ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.702ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.902ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.792ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.905ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.016ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.018ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.113ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.882ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.764ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.596ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.580ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.734ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.607ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.652ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.646ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.579ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.581ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.795ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.608ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.561ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.583ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:28.923','2025-10-24 15:37:28.923')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.844ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:28.926','2025-10-24 15:37:28.926')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.915ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:28.928','2025-10-24 15:37:28.928')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.880ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:28.93')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[3.315ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:28.932')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.738ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.192ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.156ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.534ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:28.939','2025-10-24 15:37:28.939')

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.465ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.354ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.494ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.495ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.518ms] [rows:3] DELETE FROM subjects
--- FAIL: TestSimplePolicyEnforcementPoint_Validation (0.28s)
    test_helper.go:252: Failed to create test policy: failed to create policy: ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.636ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.110ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[13.838ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.033ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.591ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.207ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:28 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.574ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.452ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.644ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.335ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.351ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.706ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.269ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.781ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.917ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.145ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.102ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.507ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.664ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.915ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.107ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.265ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.025ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.822ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.772ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.849ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.874ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.832ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.623ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.846ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.989ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.315ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.476ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.071ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.967ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.608ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.473ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.823ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.764ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.088ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.848ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.809ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 
[0.477ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 
[4.698ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:29 
[0.511ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:29 
[6.403ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 
[5.948ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:29 
[0.786ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.613ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:29 
[1.121ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.903ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.871ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.665ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.668ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.561ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.603ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.535ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.945ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.483ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.608ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.978ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.397ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.870ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.689ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.934ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 
[0.412ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 
[5.583ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:29 
[0.582ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:29 
[6.527ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 
[6.126ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:29 
[0.817ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.406ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:29 
[0.575ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.741ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.662ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 
[0.453ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 
[1.860ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:29 
[0.544ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:29 
[1.028ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 
[1.101ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:29 
[0.500ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.136ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.779ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.644ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.681ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.616ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.651ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.567ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.532ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.931ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.400ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.373ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.977ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.657ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.112ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.512ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.299ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.915ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.880ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.744ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.717ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.653ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.701ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.947ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.932ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.775ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.696ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.625ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.553ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.662ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.594ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.519ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.554ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.959ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.601ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.517ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.601ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:29.19','2025-10-24 15:37:29.19')

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.703ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:29.193','2025-10-24 15:37:29.193')

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.486ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:29.196','2025-10-24 15:37:29.196')

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.938ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:29.198')

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.332ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:29.2')

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.859ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.492ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.353ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.834ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:29.206','2025-10-24 15:37:29.206')

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.373ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.366ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.514ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.806ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:29 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.497ms] [rows:3] DELETE FROM subjects
--- FAIL: TestSimplePolicyEnforcementPoint_Timeout (0.27s)
    test_helper.go:252: Failed to create test policy: failed to create policy: ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
FAIL
FAIL    abac_go_example/pep     1.722s
?       abac_go_example/storage [no test files]
FAIL
➜  ABAC-gogo-example # Run specific package tests
➜  ABAC-gogo-example go test ./evaluator -v
=== RUN   TestComplexConditionEvaluator
=== RUN   TestComplexConditionEvaluator/Simple_AND_-_both_conditions_true
=== RUN   TestComplexConditionEvaluator/Simple_AND_-_one_condition_false
=== RUN   TestComplexConditionEvaluator/Simple_OR_-_one_condition_true
=== RUN   TestComplexConditionEvaluator/Simple_OR_-_both_conditions_false
=== RUN   TestComplexConditionEvaluator/Simple_NOT_-_condition_true
=== RUN   TestComplexConditionEvaluator/Simple_NOT_-_condition_false
=== RUN   TestComplexConditionEvaluator/Nested_AND/OR_-_complex_logic
=== RUN   TestComplexConditionEvaluator/Complex_nested_with_NOT
=== RUN   TestComplexConditionEvaluator/Multiple_levels_of_nesting
--- PASS: TestComplexConditionEvaluator (0.00s)
    --- PASS: TestComplexConditionEvaluator/Simple_AND_-_both_conditions_true (0.00s)
    --- PASS: TestComplexConditionEvaluator/Simple_AND_-_one_condition_false (0.00s)
    --- PASS: TestComplexConditionEvaluator/Simple_OR_-_one_condition_true (0.00s)
    --- PASS: TestComplexConditionEvaluator/Simple_OR_-_both_conditions_false (0.00s)
    --- PASS: TestComplexConditionEvaluator/Simple_NOT_-_condition_true (0.00s)
    --- PASS: TestComplexConditionEvaluator/Simple_NOT_-_condition_false (0.00s)
    --- PASS: TestComplexConditionEvaluator/Nested_AND/OR_-_complex_logic (0.00s)
    --- PASS: TestComplexConditionEvaluator/Complex_nested_with_NOT (0.00s)
    --- PASS: TestComplexConditionEvaluator/Multiple_levels_of_nesting (0.00s)
=== RUN   TestComplexConditionStruct
=== RUN   TestComplexConditionStruct/Simple_condition_struct
=== RUN   TestComplexConditionStruct/AND_condition_with_left/right
=== RUN   TestComplexConditionStruct/OR_condition_with_conditions_array
=== RUN   TestComplexConditionStruct/NOT_condition
=== RUN   TestComplexConditionStruct/Deeply_nested_condition
--- PASS: TestComplexConditionStruct (0.00s)
    --- PASS: TestComplexConditionStruct/Simple_condition_struct (0.00s)
    --- PASS: TestComplexConditionStruct/AND_condition_with_left/right (0.00s)
    --- PASS: TestComplexConditionStruct/OR_condition_with_conditions_array (0.00s)
    --- PASS: TestComplexConditionStruct/NOT_condition (0.00s)
    --- PASS: TestComplexConditionStruct/Deeply_nested_condition (0.00s)
=== RUN   TestComplexConditionEdgeCases
=== RUN   TestComplexConditionEdgeCases/Empty_AND_array
=== RUN   TestComplexConditionEdgeCases/Empty_OR_array
=== RUN   TestComplexConditionEdgeCases/Invalid_condition_in_AND
=== RUN   TestComplexConditionEdgeCases/Mixed_valid_and_invalid_conditions_in_OR
--- PASS: TestComplexConditionEdgeCases (0.00s)
    --- PASS: TestComplexConditionEdgeCases/Empty_AND_array (0.00s)
    --- PASS: TestComplexConditionEdgeCases/Empty_OR_array (0.00s)
    --- PASS: TestComplexConditionEdgeCases/Invalid_condition_in_AND (0.00s)
    --- PASS: TestComplexConditionEdgeCases/Mixed_valid_and_invalid_conditions_in_OR (0.00s)
=== RUN   TestComplexConditionWithAllOperators
--- PASS: TestComplexConditionWithAllOperators (0.00s)
=== RUN   TestEnhancedConditionEvaluator_StringOperators
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringEquals_-_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringEquals_-_no_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringContains_-_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringContains_-_no_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringStartsWith_-_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringEndsWith_-_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringRegex_-_match
=== RUN   TestEnhancedConditionEvaluator_StringOperators/StringLike_-_match_with_wildcards
--- PASS: TestEnhancedConditionEvaluator_StringOperators (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringEquals_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringEquals_-_no_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringContains_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringContains_-_no_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringStartsWith_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringEndsWith_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringRegex_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_StringOperators/StringLike_-_match_with_wildcards (0.00s)
=== RUN   TestEnhancedConditionEvaluator_NumericOperators
=== RUN   TestEnhancedConditionEvaluator_NumericOperators/NumericEquals_-_match
=== RUN   TestEnhancedConditionEvaluator_NumericOperators/NumericGreaterThan_-_match
=== RUN   TestEnhancedConditionEvaluator_NumericOperators/NumericLessThanEquals_-_match
=== RUN   TestEnhancedConditionEvaluator_NumericOperators/NumericBetween_-_match_with_array
=== RUN   TestEnhancedConditionEvaluator_NumericOperators/NumericBetween_-_match_with_map
=== RUN   TestEnhancedConditionEvaluator_NumericOperators/NumericBetween_-_no_match
--- PASS: TestEnhancedConditionEvaluator_NumericOperators (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NumericOperators/NumericEquals_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NumericOperators/NumericGreaterThan_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NumericOperators/NumericLessThanEquals_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NumericOperators/NumericBetween_-_match_with_array (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NumericOperators/NumericBetween_-_match_with_map (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NumericOperators/NumericBetween_-_no_match (0.00s)
=== RUN   TestEnhancedConditionEvaluator_TimeOperators
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/TimeOfDay_-_exact_match
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/DayOfWeek_-_single_day_match
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/DayOfWeek_-_array_match
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/IsBusinessHours_-_match
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/TimeGreaterThan_-_match
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/TimeLessThan_-_match
=== RUN   TestEnhancedConditionEvaluator_TimeOperators/TimeBetween_-_match
--- PASS: TestEnhancedConditionEvaluator_TimeOperators (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/TimeOfDay_-_exact_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/DayOfWeek_-_single_day_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/DayOfWeek_-_array_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/IsBusinessHours_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/TimeGreaterThan_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/TimeLessThan_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_TimeOperators/TimeBetween_-_match (0.00s)
=== RUN   TestEnhancedConditionEvaluator_NetworkOperators
=== RUN   TestEnhancedConditionEvaluator_NetworkOperators/IPInRange_-_single_range_match
=== RUN   TestEnhancedConditionEvaluator_NetworkOperators/IPInRange_-_multiple_ranges_match
=== RUN   TestEnhancedConditionEvaluator_NetworkOperators/IPNotInRange_-_not_in_range
=== RUN   TestEnhancedConditionEvaluator_NetworkOperators/IsInternalIP_-_match
--- PASS: TestEnhancedConditionEvaluator_NetworkOperators (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NetworkOperators/IPInRange_-_single_range_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NetworkOperators/IPInRange_-_multiple_ranges_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NetworkOperators/IPNotInRange_-_not_in_range (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_NetworkOperators/IsInternalIP_-_match (0.00s)
=== RUN   TestEnhancedConditionEvaluator_ArrayOperators
=== RUN   TestEnhancedConditionEvaluator_ArrayOperators/ArrayContains_-_match
=== RUN   TestEnhancedConditionEvaluator_ArrayOperators/ArrayContains_-_no_match
=== RUN   TestEnhancedConditionEvaluator_ArrayOperators/ArrayNotContains_-_match
=== RUN   TestEnhancedConditionEvaluator_ArrayOperators/ArraySize_-_exact_match
=== RUN   TestEnhancedConditionEvaluator_ArrayOperators/ArraySize_-_with_operators
--- PASS: TestEnhancedConditionEvaluator_ArrayOperators (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayOperators/ArrayContains_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayOperators/ArrayContains_-_no_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayOperators/ArrayNotContains_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayOperators/ArraySize_-_exact_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayOperators/ArraySize_-_with_operators (0.00s)
=== RUN   TestEnhancedConditionEvaluator_ComplexLogic
=== RUN   TestEnhancedConditionEvaluator_ComplexLogic/And_-_all_conditions_match
=== RUN   TestEnhancedConditionEvaluator_ComplexLogic/And_-_one_condition_fails
=== RUN   TestEnhancedConditionEvaluator_ComplexLogic/Or_-_first_condition_matches
=== RUN   TestEnhancedConditionEvaluator_ComplexLogic/Not_-_negates_condition
--- PASS: TestEnhancedConditionEvaluator_ComplexLogic (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ComplexLogic/And_-_all_conditions_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ComplexLogic/And_-_one_condition_fails (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ComplexLogic/Or_-_first_condition_matches (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ComplexLogic/Not_-_negates_condition (0.00s)
=== RUN   TestEnhancedConditionEvaluator_DotNotation
=== RUN   TestEnhancedConditionEvaluator_DotNotation/Deep_nested_access_-_match
=== RUN   TestEnhancedConditionEvaluator_DotNotation/Deep_nested_numeric_-_match
=== RUN   TestEnhancedConditionEvaluator_DotNotation/Resource_metadata_access_-_match
=== RUN   TestEnhancedConditionEvaluator_DotNotation/Non-existent_path_-_no_match
--- PASS: TestEnhancedConditionEvaluator_DotNotation (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_DotNotation/Deep_nested_access_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_DotNotation/Deep_nested_numeric_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_DotNotation/Resource_metadata_access_-_match (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_DotNotation/Non-existent_path_-_no_match (0.00s)
=== RUN   TestEnhancedConditionEvaluator_PerformanceWithCache
--- PASS: TestEnhancedConditionEvaluator_PerformanceWithCache (0.00s)
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_array_element_with_brackets
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_array_element_with_dot_notation
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_nested_array_access
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/NumericEquals_-_nested_array_access
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/ArrayContains_-_regular_array_(non-indexed_path)
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_array_element_mismatch
=== RUN   TestEnhancedConditionEvaluator_ArrayAccess/Multiple_conditions_with_array_access
--- PASS: TestEnhancedConditionEvaluator_ArrayAccess (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_array_element_with_brackets (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_array_element_with_dot_notation (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_nested_array_access (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/NumericEquals_-_nested_array_access (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/ArrayContains_-_regular_array_(non-indexed_path) (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/StringEquals_-_array_element_mismatch (0.00s)
    --- PASS: TestEnhancedConditionEvaluator_ArrayAccess/Multiple_conditions_with_array_access (0.00s)
=== RUN   TestImprovedPDP_TimeBasedAttributes
--- PASS: TestImprovedPDP_TimeBasedAttributes (0.00s)
=== RUN   TestImprovedPDP_EnvironmentalContext
--- PASS: TestImprovedPDP_EnvironmentalContext (0.00s)
=== RUN   TestImprovedPDP_StructuredAttributes
--- PASS: TestImprovedPDP_StructuredAttributes (0.00s)
=== RUN   TestImprovedPDP_EnhancedConditionEvaluation
2025/10/24 22:37:29 Info: UserId not provided in context - some policies may not evaluate correctly
--- PASS: TestImprovedPDP_EnhancedConditionEvaluation (0.00s)
=== RUN   TestImprovedPDP_PolicyFiltering
--- PASS: TestImprovedPDP_PolicyFiltering (0.00s)
=== RUN   TestImprovedPDP_IntegrationWithAllFeatures
    improved_pdp_test.go:489: Comprehensive evaluation completed with result: permit
--- PASS: TestImprovedPDP_IntegrationWithAllFeatures (0.00s)
=== RUN   TestImprovedPDP_RealWorldScenarios
=== RUN   TestImprovedPDP_RealWorldScenarios/Business_hours_document_access_-_should_allow
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[IPInRange:map[environment.client_ip:[192.168.1.0/24 10.0.0.0/8]] IsBusinessHours:map[environment.is_business_hours:true] StringContains:map[user.department:Engineering] StringEquals:map[user.subject_type:employee]]
    integration_test.go:423: Expected result permit, got deny. Reason: No matching policies found (implicit deny)
    integration_test.go:429: Evaluation time should be positive
    integration_test.go:433: Scenario: Employee accessing documents during business hours from office IP
    integration_test.go:434: Result: deny (in 0ms)
    integration_test.go:435: Reason: No matching policies found (implicit deny)
=== RUN   TestImprovedPDP_RealWorldScenarios/Confidential_document_access_-_should_allow_for_senior_staff
    integration_test.go:423: Expected result permit, got deny. Reason: No matching policies found (implicit deny)
    integration_test.go:429: Evaluation time should be positive
    integration_test.go:433: Scenario: Senior staff with confidential clearance accessing confidential documents
    integration_test.go:434: Result: deny (in 0ms)
    integration_test.go:435: Reason: No matching policies found (implicit deny)
=== RUN   TestImprovedPDP_RealWorldScenarios/Weekend_restriction_-_should_deny_sensitive_operations
    integration_test.go:419: Evaluation failed: failed to enrich context: failed to get action: action not found: document:delete
=== RUN   TestImprovedPDP_RealWorldScenarios/Mobile_device_restriction_-_should_deny_admin_actions
    integration_test.go:429: Evaluation time should be positive
    integration_test.go:433: Scenario: Admin action blocked from mobile device
    integration_test.go:434: Result: deny (in 0ms)
    integration_test.go:435: Reason: No matching policies found (implicit deny)
=== RUN   TestImprovedPDP_RealWorldScenarios/After_hours_access_-_should_deny
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[IPInRange:map[environment.client_ip:[192.168.1.0/24 10.0.0.0/8]] IsBusinessHours:map[environment.is_business_hours:true] StringContains:map[user.department:Engineering] StringEquals:map[user.subject_type:employee]]
    integration_test.go:429: Evaluation time should be positive
    integration_test.go:433: Scenario: Document access blocked after business hours
    integration_test.go:434: Result: deny (in 0ms)
    integration_test.go:435: Reason: No matching policies found (implicit deny)
--- FAIL: TestImprovedPDP_RealWorldScenarios (0.00s)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Business_hours_document_access_-_should_allow (0.00s)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Confidential_document_access_-_should_allow_for_senior_staff (0.00s)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Weekend_restriction_-_should_deny_sensitive_operations (0.00s)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/Mobile_device_restriction_-_should_deny_admin_actions (0.00s)
    --- FAIL: TestImprovedPDP_RealWorldScenarios/After_hours_access_-_should_deny (0.00s)
=== RUN   TestImprovedPDP_PerformanceComparison
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-2]]
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-2]]
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-0]]
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-2]]
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-0]]
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThan:map[user.level:1] StringEquals:map[user.department:Department-0]]
    integration_test.go:639: Request 1: permit (internal: 0ms, total: 74.375µs)
    integration_test.go:639: Request 2: deny (internal: 0ms, total: 50.042µs)
    integration_test.go:644: Average evaluation time: 0ms
--- PASS: TestImprovedPDP_PerformanceComparison (0.00s)
=== RUN   TestImprovedPDP_ComplexConditionScenarios
=== RUN   TestImprovedPDP_ComplexConditionScenarios/All_conditions_match_-_should_allow
    integration_test.go:845: Complex condition result: permit (in 0ms)
=== RUN   TestImprovedPDP_ComplexConditionScenarios/Time_condition_fails_-_should_deny
2025/10/24 22:37:29 Debug: Enhanced condition evaluation failed for conditions: map[NumericGreaterThanEquals:map[user.level:5] StringEquals:map[user.department:Engineering]]
    integration_test.go:845: Complex condition result: deny (in 0ms)
=== RUN   TestImprovedPDP_ComplexConditionScenarios/All_basic_conditions_match_-_should_allow
    integration_test.go:845: Complex condition result: permit (in 0ms)
--- PASS: TestImprovedPDP_ComplexConditionScenarios (0.00s)
    --- PASS: TestImprovedPDP_ComplexConditionScenarios/All_conditions_match_-_should_allow (0.00s)
    --- PASS: TestImprovedPDP_ComplexConditionScenarios/Time_condition_fails_-_should_deny (0.00s)
    --- PASS: TestImprovedPDP_ComplexConditionScenarios/All_basic_conditions_match_-_should_allow (0.00s)
=== RUN   TestActionMatcher
--- PASS: TestActionMatcher (0.00s)
=== RUN   TestResourceMatcher
--- PASS: TestResourceMatcher (0.00s)
=== RUN   TestConditionEvaluator
=== RUN   TestConditionEvaluator/StringEquals_-_match
=== RUN   TestConditionEvaluator/StringEquals_-_no_match
=== RUN   TestConditionEvaluator/NumericLessThan_-_match
=== RUN   TestConditionEvaluator/NumericLessThan_-_no_match
=== RUN   TestConditionEvaluator/Bool_-_match
=== RUN   TestConditionEvaluator/Multiple_conditions_(AND)_-_all_match
=== RUN   TestConditionEvaluator/Multiple_conditions_(AND)_-_one_fails
=== RUN   TestConditionEvaluator/IpAddress_-_match
--- PASS: TestConditionEvaluator (0.00s)
    --- PASS: TestConditionEvaluator/StringEquals_-_match (0.00s)
    --- PASS: TestConditionEvaluator/StringEquals_-_no_match (0.00s)
    --- PASS: TestConditionEvaluator/NumericLessThan_-_match (0.00s)
    --- PASS: TestConditionEvaluator/NumericLessThan_-_no_match (0.00s)
    --- PASS: TestConditionEvaluator/Bool_-_match (0.00s)
    --- PASS: TestConditionEvaluator/Multiple_conditions_(AND)_-_all_match (0.00s)
    --- PASS: TestConditionEvaluator/Multiple_conditions_(AND)_-_one_fails (0.00s)
    --- PASS: TestConditionEvaluator/IpAddress_-_match (0.00s)
=== RUN   TestJSONActionResource
=== RUN   TestJSONActionResource/Single_string
=== RUN   TestJSONActionResource/Array_of_strings
--- PASS: TestJSONActionResource (0.00s)
    --- PASS: TestJSONActionResource/Single_string (0.00s)
    --- PASS: TestJSONActionResource/Array_of_strings (0.00s)
=== RUN   TestPolicyStatement
--- PASS: TestPolicyStatement (0.00s)
=== RUN   TestDenyOverrideAlgorithm
=== RUN   TestDenyOverrideAlgorithm/Allow_case_-_no_deny_conditions
2025/10/24 22:37:29 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:29 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:29 Debug: Legacy condition evaluation failed for conditions: map[StringEquals:map[resource.sensitivity:confidential]]
=== RUN   TestDenyOverrideAlgorithm/Deny_case_-_deny_condition_matches
2025/10/24 22:37:29 Info: UserId not provided in context - some policies may not evaluate correctly
2025/10/24 22:37:29 Info: UserId not provided in context - some policies may not evaluate correctly
--- PASS: TestDenyOverrideAlgorithm (0.00s)
    --- PASS: TestDenyOverrideAlgorithm/Allow_case_-_no_deny_conditions (0.00s)
    --- PASS: TestDenyOverrideAlgorithm/Deny_case_-_deny_condition_matches (0.00s)
=== RUN   TestNotResourceExclusion
--- PASS: TestNotResourceExclusion (0.00s)
=== RUN   TestResourceFormatValidation
--- PASS: TestResourceFormatValidation (0.00s)
=== RUN   TestPathNormalizer_BasicPaths
=== RUN   TestPathNormalizer_BasicPaths/Simple_path
=== RUN   TestPathNormalizer_BasicPaths/Nested_path
=== RUN   TestPathNormalizer_BasicPaths/Deep_nested_path
=== RUN   TestPathNormalizer_BasicPaths/Path_with_underscores
=== RUN   TestPathNormalizer_BasicPaths/Empty_path
=== RUN   TestPathNormalizer_BasicPaths/Only_whitespace
=== RUN   TestPathNormalizer_BasicPaths/Path_with_extra_spaces_(trimmed)
=== RUN   TestPathNormalizer_BasicPaths/Path_with_double_dots_(filtered)
=== RUN   TestPathNormalizer_BasicPaths/Invalid_identifier_-_starts_with_number
=== RUN   TestPathNormalizer_BasicPaths/Invalid_identifier_-_special_characters
--- PASS: TestPathNormalizer_BasicPaths (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Simple_path (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Nested_path (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Deep_nested_path (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Path_with_underscores (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Empty_path (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Only_whitespace (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Path_with_extra_spaces_(trimmed) (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Path_with_double_dots_(filtered) (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Invalid_identifier_-_starts_with_number (0.00s)
    --- PASS: TestPathNormalizer_BasicPaths/Invalid_identifier_-_special_characters (0.00s)
=== RUN   TestPathNormalizer_ArrayAccess
=== RUN   TestPathNormalizer_ArrayAccess/Array_access_with_brackets
=== RUN   TestPathNormalizer_ArrayAccess/Array_access_with_dot_notation
=== RUN   TestPathNormalizer_ArrayAccess/Multiple_array_accesses
=== RUN   TestPathNormalizer_ArrayAccess/Array_access_then_property
=== RUN   TestPathNormalizer_ArrayAccess/Nested_array_access_mixed_notation
=== RUN   TestPathNormalizer_ArrayAccess/Invalid_bracket_-_unclosed
=== RUN   TestPathNormalizer_ArrayAccess/Invalid_bracket_-_not_at_end
=== RUN   TestPathNormalizer_ArrayAccess/Invalid_array_index_-_negative
=== RUN   TestPathNormalizer_ArrayAccess/Invalid_array_index_-_non-numeric
=== RUN   TestPathNormalizer_ArrayAccess/Large_array_index
--- PASS: TestPathNormalizer_ArrayAccess (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Array_access_with_brackets (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Array_access_with_dot_notation (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Multiple_array_accesses (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Array_access_then_property (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Nested_array_access_mixed_notation (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Invalid_bracket_-_unclosed (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Invalid_bracket_-_not_at_end (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Invalid_array_index_-_negative (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Invalid_array_index_-_non-numeric (0.00s)
    --- PASS: TestPathNormalizer_ArrayAccess/Large_array_index (0.00s)
=== RUN   TestPathNormalizer_EdgeCases
=== RUN   TestPathNormalizer_EdgeCases/Leading_dot
=== RUN   TestPathNormalizer_EdgeCases/Trailing_dot
=== RUN   TestPathNormalizer_EdgeCases/Multiple_consecutive_dots
=== RUN   TestPathNormalizer_EdgeCases/Only_dots
=== RUN   TestPathNormalizer_EdgeCases/Array_index_at_start_(not_allowed_as_field_name)
=== RUN   TestPathNormalizer_EdgeCases/Empty_brackets
=== RUN   TestPathNormalizer_EdgeCases/Space_in_identifier
--- PASS: TestPathNormalizer_EdgeCases (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Leading_dot (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Trailing_dot (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Multiple_consecutive_dots (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Only_dots (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Array_index_at_start_(not_allowed_as_field_name) (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Empty_brackets (0.00s)
    --- PASS: TestPathNormalizer_EdgeCases/Space_in_identifier (0.00s)
=== RUN   TestParsePath_Convenience
--- PASS: TestParsePath_Convenience (0.00s)
=== RUN   TestDirectPathResolver
=== RUN   TestDirectPathResolver/Existing_key
=== RUN   TestDirectPathResolver/Non-existing_key
=== RUN   TestDirectPathResolver/Empty_string_path
=== RUN   TestDirectPathResolver/Colon_notation_key
--- PASS: TestDirectPathResolver (0.00s)
    --- PASS: TestDirectPathResolver/Existing_key (0.00s)
    --- PASS: TestDirectPathResolver/Non-existing_key (0.00s)
    --- PASS: TestDirectPathResolver/Empty_string_path (0.00s)
    --- PASS: TestDirectPathResolver/Colon_notation_key (0.00s)
=== RUN   TestDotNotationResolver
=== RUN   TestDotNotationResolver/Simple_nested_path
=== RUN   TestDotNotationResolver/Deep_nested_path
=== RUN   TestDotNotationResolver/Non-existent_nested_path
=== RUN   TestDotNotationResolver/Path_without_dots_-_should_not_process
=== RUN   TestDotNotationResolver/Broken_path_-_intermediate_not_a_map
=== RUN   TestDotNotationResolver/First_part_missing
--- PASS: TestDotNotationResolver (0.00s)
    --- PASS: TestDotNotationResolver/Simple_nested_path (0.00s)
    --- PASS: TestDotNotationResolver/Deep_nested_path (0.00s)
    --- PASS: TestDotNotationResolver/Non-existent_nested_path (0.00s)
    --- PASS: TestDotNotationResolver/Path_without_dots_-_should_not_process (0.00s)
    --- PASS: TestDotNotationResolver/Broken_path_-_intermediate_not_a_map (0.00s)
    --- PASS: TestDotNotationResolver/First_part_missing (0.00s)
=== RUN   TestColonFallbackResolver
=== RUN   TestColonFallbackResolver/Convert_dot_to_colon_successfully
=== RUN   TestColonFallbackResolver/Path_without_dots_-_should_not_process
=== RUN   TestColonFallbackResolver/Non-existent_colon_path
=== RUN   TestColonFallbackResolver/Multiple_dots_-_only_first_converted
--- PASS: TestColonFallbackResolver (0.00s)
    --- PASS: TestColonFallbackResolver/Convert_dot_to_colon_successfully (0.00s)
    --- PASS: TestColonFallbackResolver/Path_without_dots_-_should_not_process (0.00s)
    --- PASS: TestColonFallbackResolver/Non-existent_colon_path (0.00s)
    --- PASS: TestColonFallbackResolver/Multiple_dots_-_only_first_converted (0.00s)
=== RUN   TestShortcutResolver
=== RUN   TestShortcutResolver/user.x_->_user.attributes.x
=== RUN   TestShortcutResolver/resource.x_->_resource.attributes.x
=== RUN   TestShortcutResolver/Deep_nested_in_attributes
=== RUN   TestShortcutResolver/Non-shortcut_prefix_-_should_not_process
=== RUN   TestShortcutResolver/Missing_attributes_map
=== RUN   TestShortcutResolver/Attributes_is_not_a_map
=== RUN   TestShortcutResolver/Path_without_dots
=== RUN   TestShortcutResolver/User_context_is_not_a_map
--- PASS: TestShortcutResolver (0.00s)
    --- PASS: TestShortcutResolver/user.x_->_user.attributes.x (0.00s)
    --- PASS: TestShortcutResolver/resource.x_->_resource.attributes.x (0.00s)
    --- PASS: TestShortcutResolver/Deep_nested_in_attributes (0.00s)
    --- PASS: TestShortcutResolver/Non-shortcut_prefix_-_should_not_process (0.00s)
    --- PASS: TestShortcutResolver/Missing_attributes_map (0.00s)
    --- PASS: TestShortcutResolver/Attributes_is_not_a_map (0.00s)
    --- PASS: TestShortcutResolver/Path_without_dots (0.00s)
    --- PASS: TestShortcutResolver/User_context_is_not_a_map (0.00s)
=== RUN   TestCompositePathResolver
=== RUN   TestCompositePathResolver/Direct_path_-_highest_priority
=== RUN   TestCompositePathResolver/Dot_notation_-_second_priority
=== RUN   TestCompositePathResolver/Colon_fallback_-_third_priority
=== RUN   TestCompositePathResolver/Shortcut_resolver_-_fourth_priority
=== RUN   TestCompositePathResolver/None_found
=== RUN   TestCompositePathResolver/Priority_test_-_direct_wins_over_nested
--- PASS: TestCompositePathResolver (0.00s)
    --- PASS: TestCompositePathResolver/Direct_path_-_highest_priority (0.00s)
    --- PASS: TestCompositePathResolver/Dot_notation_-_second_priority (0.00s)
    --- PASS: TestCompositePathResolver/Colon_fallback_-_third_priority (0.00s)
    --- PASS: TestCompositePathResolver/Shortcut_resolver_-_fourth_priority (0.00s)
    --- PASS: TestCompositePathResolver/None_found (0.00s)
    --- PASS: TestCompositePathResolver/Priority_test_-_direct_wins_over_nested (0.00s)
=== RUN   TestShortcutResolver_CustomConfig
=== RUN   TestShortcutResolver_CustomConfig/resource.x_->_resource.metadata.x_(custom_config)
=== RUN   TestShortcutResolver_CustomConfig/environment.x_->_environment.properties.x_(new_shortcut)
=== RUN   TestShortcutResolver_CustomConfig/Deep_target_path
=== RUN   TestShortcutResolver_CustomConfig/No_shortcut_for_prefix
--- PASS: TestShortcutResolver_CustomConfig (0.00s)
    --- PASS: TestShortcutResolver_CustomConfig/resource.x_->_resource.metadata.x_(custom_config) (0.00s)
    --- PASS: TestShortcutResolver_CustomConfig/environment.x_->_environment.properties.x_(new_shortcut) (0.00s)
    --- PASS: TestShortcutResolver_CustomConfig/Deep_target_path (0.00s)
    --- PASS: TestShortcutResolver_CustomConfig/No_shortcut_for_prefix (0.00s)
=== RUN   TestShortcutResolver_DeepTargetPath
--- PASS: TestShortcutResolver_DeepTargetPath (0.00s)
=== RUN   TestNavigateNestedMap
=== RUN   TestNavigateNestedMap/Single_part
=== RUN   TestNavigateNestedMap/Multiple_parts
=== RUN   TestNavigateNestedMap/Missing_intermediate_part
=== RUN   TestNavigateNestedMap/Intermediate_part_not_a_map
=== RUN   TestNavigateNestedMap/Empty_parts
--- PASS: TestNavigateNestedMap (0.00s)
    --- PASS: TestNavigateNestedMap/Single_part (0.00s)
    --- PASS: TestNavigateNestedMap/Multiple_parts (0.00s)
    --- PASS: TestNavigateNestedMap/Missing_intermediate_part (0.00s)
    --- PASS: TestNavigateNestedMap/Intermediate_part_not_a_map (0.00s)
    --- PASS: TestNavigateNestedMap/Empty_parts (0.00s)
=== RUN   TestArrayAccessResolver
=== RUN   TestArrayAccessResolver/Simple_array_access_with_brackets
=== RUN   TestArrayAccessResolver/Array_access_with_dot_notation
=== RUN   TestArrayAccessResolver/Array_access_then_property
=== RUN   TestArrayAccessResolver/Nested_array_access
=== RUN   TestArrayAccessResolver/Array_index_out_of_bounds
=== RUN   TestArrayAccessResolver/Array_access_on_non-array
=== RUN   TestArrayAccessResolver/Path_without_array_access_-_should_not_process
=== RUN   TestArrayAccessResolver/Mixed_notation
--- PASS: TestArrayAccessResolver (0.00s)
    --- PASS: TestArrayAccessResolver/Simple_array_access_with_brackets (0.00s)
    --- PASS: TestArrayAccessResolver/Array_access_with_dot_notation (0.00s)
    --- PASS: TestArrayAccessResolver/Array_access_then_property (0.00s)
    --- PASS: TestArrayAccessResolver/Nested_array_access (0.00s)
    --- PASS: TestArrayAccessResolver/Array_index_out_of_bounds (0.00s)
    --- PASS: TestArrayAccessResolver/Array_access_on_non-array (0.00s)
    --- PASS: TestArrayAccessResolver/Path_without_array_access_-_should_not_process (0.00s)
    --- PASS: TestArrayAccessResolver/Mixed_notation (0.00s)
=== RUN   TestCompositePathResolver_WithArrayAccess
=== RUN   TestCompositePathResolver_WithArrayAccess/Array_access_via_composite
=== RUN   TestCompositePathResolver_WithArrayAccess/Regular_path_still_works
=== RUN   TestCompositePathResolver_WithArrayAccess/Priority:_direct_path_over_array_access
--- PASS: TestCompositePathResolver_WithArrayAccess (0.00s)
    --- PASS: TestCompositePathResolver_WithArrayAccess/Array_access_via_composite (0.00s)
    --- PASS: TestCompositePathResolver_WithArrayAccess/Regular_path_still_works (0.00s)
    --- PASS: TestCompositePathResolver_WithArrayAccess/Priority:_direct_path_over_array_access (0.00s)
FAIL
FAIL    abac_go_example/evaluator       0.013s
FAIL
➜  ABAC-gogo-example go test ./storage -v
?       abac_go_example/storage [no test files]
➜  ABAC-gogo-example # Run benchmarks
➜  ABAC-gogo-example go test -bench=. -benchmem

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.950ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.251ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[13.270ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.098ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.147ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.920ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.677ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.718ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.950ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.591ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.933ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.072ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.862ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.838ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.092ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.585ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.575ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.625ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.988ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.950ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.867ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.310ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.094ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.993ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.859ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.954ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.705ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.729ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.091ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.868ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.921ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.206ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.097ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.073ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.955ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.486ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.930ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.048ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.953ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.399ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.057ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.848ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 
[0.537ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 
[4.599ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:30 
[0.646ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:30 
[6.734ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 
[6.645ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:30 
[0.997ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.713ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:30 
[1.507ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.844ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.856ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.996ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.008ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.773ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.702ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.624ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.079ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.643ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.060ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.109ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.614ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.880ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.887ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.118ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 
[0.777ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 
[5.011ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:30 
[0.682ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:30 
[6.642ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 
[6.376ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:30 
[1.034ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.160ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:30 
[0.717ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.921ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.706ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 
[0.586ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 
[1.832ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:30 
[0.703ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:30 
[1.279ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 
[1.607ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:30 
[0.617ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.367ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.022ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.784ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.622ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.726ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.653ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.526ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.514ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.047ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.418ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.714ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.239ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.343ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.032ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.621ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.893ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.915ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.858ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.896ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.815ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.973ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.751ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.935ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.749ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.727ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.684ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.594ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.665ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.580ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.636ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.707ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.644ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.732ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.555ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.614ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.954ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:30.592','2025-10-24 15:37:30.592')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.886ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:30.595','2025-10-24 15:37:30.595')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.423ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:30.597','2025-10-24 15:37:30.597')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.811ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:30.598')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.209ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:30.6')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.621ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.169ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.203ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.671ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:30.605','2025-10-24 15:37:30.605')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.453ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.404ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.611ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.571ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.517ms] [rows:3] DELETE FROM subjects
goos: darwin
goarch: arm64
pkg: abac_go_example
cpu: Apple M1 Pro
BenchmarkSingleEvaluation-8     
2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.135ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.185ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[11.790ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'subjects'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.282ms] [rows:-] SELECT * FROM "subjects" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.922ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[8.514ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'subjects'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.752ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'subjects'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.338ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.345ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'external_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.388ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'subject_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.371ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.470ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[2.270ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.891ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'subjects' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'subjects' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.071ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_external_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.361ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'subjects' AND indexname = 'idx_subjects_subject_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.448ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.494ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[5.005ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'resources'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.093ms] [rows:-] SELECT * FROM "resources" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[9.214ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.481ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'resources'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.008ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'resources'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.961ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.014ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_type') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.842ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.764ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'path') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.766ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'parent_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.707ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'metadata') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.948ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'attributes') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.879ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'resources' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'resources' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.397ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_type' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.115ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.221ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'resources' AND indexname = 'idx_resources_parent_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.290ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.477ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.521ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.010ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.338ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[10.188ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.933ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.872ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 
[0.575ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 
[4.773ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'actions'

2025/10/24 22:37:30 
[0.661ms] [rows:-] SELECT * FROM "actions" LIMIT 1

2025/10/24 22:37:30 
[8.265ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 
[6.260ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'actions'

2025/10/24 22:37:30 
[0.790ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'actions'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[3.258ms] [rows:0] ALTER TABLE "actions" ALTER COLUMN "action_name" TYPE varchar(100) USING "action_name"::varchar(100)

2025/10/24 22:37:30 
[1.238ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.032ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.024ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'action_category') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.927ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.751ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'actions' AND column_name = 'is_system') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'actions' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.634ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.700ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_action_category' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.653ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'actions' AND indexname = 'idx_actions_is_system' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.145ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.485ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[4.867ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.027ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.596ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[6.731ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.128ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.959ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 
[0.536ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 
[5.117ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:30 
[0.588ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:30 
[6.370ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 
[7.236ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:30 
[1.030ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.472ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "policy_name" TYPE varchar(255) USING "policy_name"::varchar(255)

2025/10/24 22:37:30 
[0.565ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.819ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'policy_name') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.631ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'description') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 
[0.436ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 
[1.854ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'policies'

2025/10/24 22:37:30 
[0.564ms] [rows:-] SELECT * FROM "policies" LIMIT 1

2025/10/24 22:37:30 
[1.093ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 
[1.069ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'policies'

2025/10/24 22:37:30 
[0.506ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'policies'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.281ms] [rows:0] ALTER TABLE "policies" ALTER COLUMN "version" TYPE varchar(50) USING "version"::varchar(50)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.881ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'version') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.937ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'statement') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.066ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'enabled') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.807ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.884ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'policies' AND column_name = 'updated_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'policies' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.539ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_policy_name' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.488ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'policies' AND indexname = 'idx_policies_enabled' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.961ms] [rows:1] SELECT count(*) FROM information_schema.tables WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND table_type = 'BASE TABLE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.383ms] [rows:1] SELECT CURRENT_DATABASE()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.508ms] [rows:-] SELECT c.column_name, c.is_nullable = 'YES', c.udt_name, c.character_maximum_length, c.numeric_precision, c.numeric_precision_radix, c.numeric_scale, c.datetime_precision, 8 * typlen, c.column_default, pd.description, c.identity_increment FROM information_schema.columns AS c JOIN pg_type AS pgt ON c.udt_name = pgt.typname LEFT JOIN pg_catalog.pg_description as pd ON pd.objsubid = c.ordinal_position AND pd.objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = c.table_name AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = c.table_schema)) where table_catalog = 'abac_test' AND table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.946ms] [rows:-] SELECT * FROM "audit_logs" LIMIT 1

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.038ms] [rows:-] SELECT constraint_name FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs' AND constraint_type = 'UNIQUE'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[1.079ms] [rows:-] SELECT c.column_name, constraint_name, constraint_type FROM information_schema.table_constraints tc JOIN information_schema.constraint_column_usage AS ccu USING (constraint_schema, constraint_catalog, table_name, constraint_name) JOIN information_schema.columns AS c ON c.table_schema = tc.constraint_schema AND tc.table_name = c.table_name AND ccu.column_name = c.column_name WHERE constraint_type IN ('PRIMARY KEY', 'UNIQUE') AND c.table_catalog = 'abac_test' AND c.table_schema = CURRENT_SCHEMA() AND c.table_name = 'audit_logs'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.561ms] [rows:-] SELECT a.attname as column_name, format_type(a.atttypid, a.atttypmod) AS data_type
                FROM pg_attribute a JOIN pg_class b ON a.attrelid = b.oid AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA())
                WHERE a.attnum > 0 -- hide internal columns
                AND NOT a.attisdropped -- hide deleted columns
                AND b.relname = 'audit_logs'

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.764ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.774ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'request_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.710ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'subject_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.752ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'resource_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.759ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'action_id') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.934ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'decision') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.739ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'evaluation_ms') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.722ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'context') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.840ms] [rows:0] SELECT description FROM pg_catalog.pg_description WHERE objsubid = (SELECT ordinal_position FROM information_schema.columns WHERE table_schema = CURRENT_SCHEMA() AND table_name = 'audit_logs' AND column_name = 'created_at') AND objoid = (SELECT oid FROM pg_catalog.pg_class WHERE relname = 'audit_logs' AND relnamespace = (SELECT oid FROM pg_catalog.pg_namespace WHERE nspname = CURRENT_SCHEMA()))

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.633ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_subject_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.692ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_resource_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.722ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_action_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.732ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_decision' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.838ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_created_at' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:38
[0.814ms] [rows:1] SELECT count(*) FROM pg_indexes WHERE tablename = 'audit_logs' AND indexname = 'idx_audit_logs_request_id' AND schemaname = CURRENT_SCHEMA()

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.636ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.718ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.749ms] [rows:0] DELETE FROM actions

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.536ms] [rows:0] DELETE FROM resources

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.570ms] [rows:0] DELETE FROM subjects

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[2.324ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-001','john.doe@company.com','user','{"email":"john.doe@company.com","employee_id":"EMP-12345","full_name":"John Doe"}','{"clearance_level":3,"department":"engineering","location":"VN-HCM","role":["senior_developer","code_reviewer"],"team":"platform","years_of_service":5}','2025-10-24 15:37:30.861','2025-10-24 15:37:30.861')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.403ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-002','alice.smith@company.com','user','{"email":"alice.smith@company.com","employee_id":"EMP-23456","full_name":"Alice Smith"}','{"clearance_level":2,"department":"finance","location":"VN-HN","role":["accountant","report_viewer"],"team":"accounts","years_of_service":3}','2025-10-24 15:37:30.864','2025-10-24 15:37:30.864')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:128
[1.230ms] [rows:1] INSERT INTO "subjects" ("id","external_id","subject_type","metadata","attributes","created_at","updated_at") VALUES ('sub-004','bob.wilson@company.com','user','{"email":"bob.wilson@company.com","employee_id":"EMP-34567","full_name":"Bob Wilson"}','{"clearance_level":1,"department":"engineering","location":"VN-DN","on_probation":true,"role":["junior_developer"],"team":"frontend","years_of_service":1}','2025-10-24 15:37:30.865','2025-10-24 15:37:30.865')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.640ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001','api_endpoint','/api/v1/users','api.v1.users','','{"description":"User management API","version":"v1"}','{"data_classification":"internal","methods":["GET","POST","PUT","DELETE"],"pii_data":true,"rate_limit":1000,"requires_auth":true}','2025-10-24 15:37:30.866')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:137
[1.290ms] [rows:1] INSERT INTO "resources" ("id","resource_type","resource_id","path","parent_id","metadata","attributes","created_at") VALUES ('res-001-financial','api_endpoint','/api/v1/financial','api.v1.financial','','{"description":"Financial data API","version":"v1"}','{"data_classification":"highly_confidential","department":"finance","methods":["GET"],"rate_limit":100,"requires_auth":true}','2025-10-24 15:37:30.868')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.506ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-001','read','crud','Read/View resource',false)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.266ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-002','write','crud','Create/Update resource',false)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:146
[1.219ms] [rows:1] INSERT INTO "actions" ("id","action_name","action_category","description","is_system") VALUES ('act-006','admin','system','Administrative access',true)

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/postgresql_storage.go:155 ERROR: null value in column "effect" of relation "policies" violates not-null constraint (SQLSTATE 23502)
[1.627ms] [rows:0] INSERT INTO "policies" ("id","policy_name","description","version","statement","enabled","created_at","updated_at") VALUES ('pol-001','Engineering Read Access','Allow engineering team to read technical resources','2024-10-21','[{"Sid":"EngineeringReadAccess","Effect":"Allow","Action":"document-service:file:read","Resource":"api:documents:dept:engineering/*","NotResource":"","Condition":{"StringEquals":{"user.department":"engineering"}}}]',true,'2025-10-24 15:37:30.873','2025-10-24 15:37:30.873')

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:45
[0.512ms] [rows:0] DELETE FROM audit_logs

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:46
[0.456ms] [rows:0] DELETE FROM policies

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:47
[0.694ms] [rows:3] DELETE FROM actions

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:48
[0.699ms] [rows:2] DELETE FROM resources

2025/10/24 22:37:30 /Users/nhan/Documents/phx/ABAC-gogo-example/storage/test_helper.go:49
[0.584ms] [rows:3] DELETE FROM subjects
       0                       NaN ns/op               0 B/op          0 allocs/op
PASS
ok      abac_go_example 0.575s
➜  ABAC-gogo-example git:(main) ✗ 

