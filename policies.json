{
  "policies": [
    {
      "id": "pol-001",
      "policy_name": "Engineering Read Access",
      "description": "Allow engineering team to read technical resources",
      "effect": "permit",
      "priority": 100,
      "enabled": true,
      "version": 1,
      "conditions": {
        "all": [
          {
            "subject.attributes.department": "engineering"
          },
          {
            "resource.attributes.data_classification": {
              "$in": ["public", "internal"]
            }
          },
          {
            "action": "read"
          }
        ]
      },
      "rules": [
        {
          "target_type": "subject",
          "attribute_path": "attributes.department",
          "operator": "eq",
          "expected_value": "engineering"
        },
        {
          "target_type": "resource",
          "attribute_path": "attributes.data_classification",
          "operator": "in",
          "expected_value": ["public", "internal"]
        }
      ],
      "actions": ["read"],
      "resource_patterns": ["/api/v1/*", "/docs/technical/*"]
    },
    {
      "id": "pol-002",
      "policy_name": "Senior Developer Write Access",
      "description": "Senior developers can write to production APIs",
      "effect": "permit",
      "priority": 50,
      "enabled": true,
      "version": 2,
      "conditions": {
        "all": [
          {
            "subject.attributes.role": {
              "$contains": "senior_developer"
            }
          },
          {
            "subject.attributes.years_of_service": {
              "$gte": 2
            }
          },
          {
            "resource.resource_type": "api_endpoint"
          },
          {
            "environment.time_of_day": {
              "$between": ["08:00", "20:00"]
            }
          }
        ]
      },
      "rules": [
        {
          "target_type": "subject",
          "attribute_path": "attributes.role",
          "operator": "contains",
          "expected_value": "senior_developer"
        },
        {
          "target_type": "subject",
          "attribute_path": "attributes.years_of_service",
          "operator": "gte",
          "expected_value": 2
        },
        {
          "target_type": "environment",
          "attribute_path": "time_of_day",
          "operator": "between",
          "expected_value": ["08:00", "20:00"]
        }
      ],
      "actions": ["read", "write"],
      "resource_patterns": ["/api/v1/*"]
    },
    {
      "id": "pol-003",
      "policy_name": "Finance Confidential Access",
      "description": "Finance team access to confidential financial data",
      "effect": "permit",
      "priority": 30,
      "enabled": true,
      "version": 1,
      "conditions": {
        "all": [
          {
            "subject.attributes.department": "finance"
          },
          {
            "subject.attributes.clearance_level": {
              "$gte": 2
            }
          },
          {
            "resource.attributes.document_type": "financial_report"
          }
        ]
      },
      "rules": [
        {
          "target_type": "subject",
          "attribute_path": "attributes.department",
          "operator": "eq",
          "expected_value": "finance"
        },
        {
          "target_type": "subject",
          "attribute_path": "attributes.clearance_level",
          "operator": "gte",
          "expected_value": 2
        },
        {
          "target_type": "resource",
          "attribute_path": "attributes.document_type",
          "operator": "eq",
          "expected_value": "financial_report"
        }
      ],
      "actions": ["read", "write", "approve"],
      "resource_patterns": ["DOC-*-FINANCE"]
    },
    {
      "id": "pol-004",
      "policy_name": "Deny Probation Write",
      "description": "Deny write access for employees on probation",
      "effect": "deny",
      "priority": 10,
      "enabled": true,
      "version": 1,
      "conditions": {
        "all": [
          {
            "subject.attributes.on_probation": true
          },
          {
            "action": {
              "$in": ["write", "delete", "deploy"]
            }
          }
        ]
      },
      "rules": [
        {
          "target_type": "subject",
          "attribute_path": "attributes.on_probation",
          "operator": "eq",
          "expected_value": true
        }
      ],
      "actions": ["write", "delete", "deploy"],
      "resource_patterns": ["*"]
    },
    {
      "id": "pol-005",
      "policy_name": "Service to Service Communication",
      "description": "Allow internal services to communicate",
      "effect": "permit",
      "priority": 80,
      "enabled": true,
      "version": 1,
      "conditions": {
        "all": [
          {
            "subject.subject_type": "service"
          },
          {
            "subject.attributes.service_type": "internal"
          },
          {
            "resource.resource_type": "api_endpoint"
          },
          {
            "environment.source_ip": {
              "$regex": "^10\\."
            }
          }
        ]
      },
      "rules": [
        {
          "target_type": "subject",
          "attribute_path": "subject_type",
          "operator": "eq",
          "expected_value": "service"
        },
        {
          "target_type": "subject",
          "attribute_path": "attributes.service_type",
          "operator": "eq",
          "expected_value": "internal"
        },
        {
          "target_type": "environment",
          "attribute_path": "source_ip",
          "operator": "regex",
          "expected_value": "^10\\."
        }
      ],
      "actions": ["read", "write", "execute"],
      "resource_patterns": ["/api/internal/*"]
    }
  ]
}