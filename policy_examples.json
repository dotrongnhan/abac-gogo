{
  "policies": [
    {
      "id": "pol-001",
      "policy_name": "Department Document Access",
      "description": "Allow users to access documents in their department",
      "version": "2024-10-21",
      "statement": [
        {
          "Sid": "OwnDocumentsFullAccess",
          "Effect": "Allow",
          "Action": "document-service:file:*",
          "Resource": "api:documents:owner:${request:UserId}/*"
        },
        {
          "Sid": "DepartmentDocumentsRead",
          "Effect": "Allow",
          "Action": [
            "document-service:file:read",
            "document-service:file:list"
          ],
          "Resource": "api:documents:dept:${user:Department}/*",
          "Condition": {
            "StringNotEquals": {
              "resource:Sensitivity": "confidential"
            }
          }
        },
        {
          "Sid": "DenyConfidentialDelete",
          "Effect": "Deny",
          "Action": "document-service:file:delete",
          "Resource": "*",
          "Condition": {
            "StringEquals": {
              "resource:Sensitivity": "confidential"
            }
          }
        }
      ],
      "enabled": true
    },
    {
      "id": "pol-002",
      "policy_name": "Payment Transaction Approval",
      "description": "Amount-based transaction approval rules",
      "version": "2024-10-21",
      "statement": [
        {
          "Sid": "SmallTransactions",
          "Effect": "Allow",
          "Action": "payment-service:transaction:approve",
          "Resource": "api:transactions:*",
          "Condition": {
            "NumericLessThan": {
              "transaction:Amount": 1000000
            }
          }
        },
        {
          "Sid": "LargeTransactionsNeedManager",
          "Effect": "Allow",
          "Action": "payment-service:transaction:approve",
          "Resource": "api:transactions:*",
          "Condition": {
            "NumericGreaterThanEquals": {
              "transaction:Amount": 1000000
            },
            "StringEquals": {
              "user:Role": "manager"
            }
          }
        }
      ],
      "enabled": true
    },
    {
      "id": "pol-003",
      "policy_name": "Business Hours Access",
      "description": "Time-based access control",
      "version": "2024-10-21",
      "statement": [
        {
          "Sid": "BusinessHoursOnly",
          "Effect": "Allow",
          "Action": "payment-service:transaction:create",
          "Resource": "api:transactions:*",
          "Condition": {
            "DateGreaterThan": {
              "request:TimeOfDay": "09:00:00"
            },
            "DateLessThan": {
              "request:TimeOfDay": "18:00:00"
            }
          }
        },
        {
          "Sid": "DenyWeekendAccess",
          "Effect": "Deny",
          "Action": "payment-service:*:*",
          "Resource": "*",
          "Condition": {
            "StringEquals": {
              "request:DayOfWeek": ["Saturday", "Sunday"]
            }
          }
        }
      ],
      "enabled": true
    },
    {
      "id": "pol-004",
      "policy_name": "IP Address Restrictions",
      "description": "Network-based access control",
      "version": "2024-10-21",
      "statement": [
        {
          "Sid": "AllowInternalNetwork",
          "Effect": "Allow",
          "Action": "*:*:*",
          "Resource": "*",
          "Condition": {
            "IpAddress": {
              "request:SourceIp": ["10.0.0.0/8", "192.168.1.0/24"]
            }
          }
        },
        {
          "Sid": "DenyExternalAccess",
          "Effect": "Deny",
          "Action": "*:*:*",
          "Resource": "*",
          "Condition": {
            "Bool": {
              "request:IsExternal": true
            }
          }
        }
      ],
      "enabled": true
    }
  ]
}
